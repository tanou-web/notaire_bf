# Generated by Django 5.2.5 on 2025-12-28 18:10

import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('system', '0001_ajout_emails_professionnels'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ScheduledTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nom')),
                ('task_type', models.CharField(choices=[('system', 'Système'), ('backup', 'Sauvegarde'), ('cleanup', 'Nettoyage'), ('report', 'Rapport'), ('sync', 'Synchronisation'), ('custom', 'Personnalisée')], default='system', max_length=20, verbose_name='Type de tâche')),
                ('status', models.CharField(choices=[('active', 'Active'), ('paused', 'En pause'), ('completed', 'Terminée'), ('failed', 'Échouée')], default='active', max_length=20, verbose_name='Statut')),
                ('command', models.CharField(help_text='Commande à exécuter', max_length=200, verbose_name='Commande')),
                ('schedule', models.CharField(help_text='Expression cron ou intervalle', max_length=100, verbose_name='Planification')),
                ('arguments', models.JSONField(blank=True, default=dict, verbose_name='Arguments')),
                ('last_run', models.DateTimeField(blank=True, null=True, verbose_name='Dernière exécution')),
                ('last_result', models.TextField(blank=True, verbose_name='Dernier résultat')),
                ('last_duration', models.FloatField(blank=True, null=True, verbose_name='Dernière durée (ms)')),
                ('next_run', models.DateTimeField(blank=True, null=True, verbose_name='Prochaine exécution')),
                ('max_retries', models.IntegerField(default=3, verbose_name='Tentatives max')),
                ('retry_count', models.IntegerField(default=0, verbose_name='Nombre de tentatives')),
                ('timeout', models.IntegerField(default=300, verbose_name='Timeout (secondes)')),
                ('is_enabled', models.BooleanField(default=True, verbose_name='Activée')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Tâche planifiée',
                'verbose_name_plural': 'Tâches planifiées',
                'db_table': 'system_scheduled_task',
                'ordering': ['-next_run'],
            },
        ),
        migrations.CreateModel(
            name='SystemHealth',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('service', models.CharField(max_length=100, unique=True, verbose_name='Service')),
                ('status', models.CharField(choices=[('healthy', 'Sain'), ('degraded', 'Dégradé'), ('unhealthy', 'Malsain'), ('unknown', 'Inconnu')], default='unknown', max_length=20, verbose_name='Statut')),
                ('last_check', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Dernière vérification')),
                ('response_time', models.FloatField(blank=True, null=True, verbose_name='Temps de réponse (ms)')),
                ('details', models.JSONField(blank=True, default=dict, verbose_name='Détails')),
                ('error_message', models.TextField(blank=True, verbose_name="Message d'erreur")),
            ],
            options={
                'verbose_name': 'Santé système',
                'verbose_name_plural': 'Santés système',
                'db_table': 'system_health',
                'ordering': ['service'],
            },
        ),
        migrations.AlterField(
            model_name='systememailprofessionnel',
            name='id',
            field=models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID'),
        ),
        migrations.CreateModel(
            name='APIKey',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nom')),
                ('key', models.CharField(max_length=100, unique=True, verbose_name='Clé')),
                ('secret', models.CharField(max_length=200, verbose_name='Secret')),
                ('status', models.CharField(choices=[('active', 'Active'), ('inactive', 'Inactive'), ('revoked', 'Révoquée'), ('expired', 'Expirée')], default='active', max_length=20, verbose_name='Statut')),
                ('permissions', models.JSONField(default=list, help_text='Liste des permissions accordées', verbose_name='Permissions')),
                ('rate_limit', models.IntegerField(default=100, help_text='Requêtes par heure', verbose_name='Limite de débit')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='Expire le')),
                ('last_used', models.DateTimeField(blank=True, null=True, verbose_name='Dernière utilisation')),
                ('total_requests', models.IntegerField(default=0, verbose_name='Total requêtes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_api_keys', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
            ],
            options={
                'verbose_name': 'Clé API',
                'verbose_name_plural': 'Clés API',
                'db_table': 'system_api_key',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MaintenanceWindow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='Titre')),
                ('description', models.TextField(verbose_name='Description')),
                ('maintenance_type', models.CharField(choices=[('scheduled', 'Planifiée'), ('emergency', 'Urgence'), ('routine', 'Routine')], default='scheduled', max_length=20, verbose_name='Type')),
                ('status', models.CharField(choices=[('scheduled', 'Planifiée'), ('in_progress', 'En cours'), ('completed', 'Terminée'), ('cancelled', 'Annulée')], default='scheduled', max_length=20, verbose_name='Statut')),
                ('start_time', models.DateTimeField(verbose_name='Heure de début')),
                ('end_time', models.DateTimeField(verbose_name='Heure de fin')),
                ('affected_services', models.JSONField(default=list, verbose_name='Services affectés')),
                ('impact_level', models.CharField(choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], default='medium', max_length=20, verbose_name="Niveau d'impact")),
                ('notification_sent', models.BooleanField(default=False, verbose_name='Notification envoyée')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_maintenances', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
            ],
            options={
                'verbose_name': 'Fenêtre de maintenance',
                'verbose_name_plural': 'Fenêtres de maintenance',
                'db_table': 'system_maintenance',
                'ordering': ['-start_time'],
            },
        ),
        migrations.CreateModel(
            name='SystemMetric',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('metric_type', models.CharField(choices=[('cpu', 'CPU'), ('memory', 'Mémoire'), ('disk', 'Disque'), ('network', 'Réseau'), ('database', 'Base de données'), ('request', 'Requête'), ('response_time', 'Temps de réponse'), ('error_rate', "Taux d'erreur"), ('custom', 'Personnalisé')], max_length=50, verbose_name='Type de métrique')),
                ('name', models.CharField(max_length=100, verbose_name='Nom')),
                ('value', models.FloatField(verbose_name='Valeur')),
                ('unit', models.CharField(blank=True, default='', max_length=20, verbose_name='Unité')),
                ('tags', models.JSONField(blank=True, default=dict, verbose_name='Tags')),
                ('hostname', models.CharField(blank=True, max_length=100, verbose_name="Nom d'hôte")),
                ('collected_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Collecté à')),
            ],
            options={
                'verbose_name': 'Métrique système',
                'verbose_name_plural': 'Métriques système',
                'db_table': 'system_metric',
                'ordering': ['-collected_at'],
                'indexes': [models.Index(fields=['metric_type', 'collected_at'], name='system_metr_metric__ff9570_idx'), models.Index(fields=['name', 'collected_at'], name='system_metr_name_5a85c9_idx'), models.Index(fields=['hostname'], name='system_metr_hostnam_893ae3_idx')],
            },
        ),
        migrations.CreateModel(
            name='SystemNotification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='Titre')),
                ('message', models.TextField(verbose_name='Message')),
                ('notification_type', models.CharField(choices=[('info', 'Information'), ('warning', 'Avertissement'), ('error', 'Erreur'), ('success', 'Succès'), ('maintenance', 'Maintenance'), ('security', 'Sécurité')], default='info', max_length=20, verbose_name='Type')),
                ('priority', models.CharField(choices=[('low', 'Basse'), ('medium', 'Moyenne'), ('high', 'Haute'), ('urgent', 'Urgente')], default='medium', max_length=20, verbose_name='Priorité')),
                ('is_read', models.BooleanField(default=False, verbose_name='Lu')),
                ('is_acknowledged', models.BooleanField(default=False, verbose_name='Acquitté')),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True, verbose_name='Acquitté le')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='Expire le')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acknowledged_notifications', to=settings.AUTH_USER_MODEL, verbose_name='Acquitté par')),
            ],
            options={
                'verbose_name': 'Notification système',
                'verbose_name_plural': 'Notifications système',
                'db_table': 'system_notification',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SystemConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('key', models.CharField(help_text='Clé unique de la configuration', max_length=100, unique=True, verbose_name='Clé')),
                ('value', models.TextField(help_text='Valeur de la configuration', verbose_name='Valeur')),
                ('value_type', models.CharField(choices=[('string', 'Chaîne'), ('integer', 'Entier'), ('float', 'Nombre décimal'), ('boolean', 'Booléen'), ('json', 'JSON'), ('datetime', 'Date/Heure'), ('file', 'Fichier')], default='string', max_length=20, verbose_name='Type de valeur')),
                ('category', models.CharField(choices=[('general', 'Général'), ('security', 'Sécurité'), ('email', 'Email'), ('database', 'Base de données'), ('backup', 'Sauvegarde'), ('logging', 'Journalisation'), ('cache', 'Cache'), ('api', 'API'), ('integration', 'Intégration'), ('custom', 'Personnalisé')], default='general', max_length=50, verbose_name='Catégorie')),
                ('description', models.TextField(blank=True, help_text='Description de la configuration', verbose_name='Description')),
                ('is_encrypted', models.BooleanField(default=False, help_text='Si la valeur est chiffrée dans la base', verbose_name='Chiffré')),
                ('is_public', models.BooleanField(default=False, help_text='Visible par tous les utilisateurs', verbose_name='Public')),
                ('is_editable', models.BooleanField(default=True, help_text="Peut être modifié via l'interface", verbose_name='Modifiable')),
                ('is_required', models.BooleanField(default=False, help_text='Configuration obligatoire', verbose_name='Requis')),
                ('default_value', models.TextField(blank=True, verbose_name='Valeur par défaut')),
                ('validation_regex', models.CharField(blank=True, max_length=200, verbose_name='Regex de validation')),
                ('min_value', models.FloatField(blank=True, null=True, verbose_name='Valeur minimale')),
                ('max_value', models.FloatField(blank=True, null=True, verbose_name='Valeur maximale')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Créé le')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Mis à jour le')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_configs', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
            ],
            options={
                'verbose_name': 'Configuration système',
                'verbose_name_plural': 'Configurations système',
                'db_table': 'system_config',
                'ordering': ['category', 'key'],
                'indexes': [models.Index(fields=['key'], name='system_conf_key_850519_idx'), models.Index(fields=['category'], name='system_conf_categor_fa6bb0_idx'), models.Index(fields=['is_public'], name='system_conf_is_publ_537866_idx')],
            },
        ),
        migrations.CreateModel(
            name='SystemLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True, verbose_name='UUID')),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Horodatage')),
                ('level', models.CharField(choices=[('debug', 'Debug'), ('info', 'Information'), ('warning', 'Avertissement'), ('error', 'Erreur'), ('critical', 'Critique')], default='info', max_length=20, verbose_name='Niveau')),
                ('source', models.CharField(choices=[('system', 'Système'), ('api', 'API'), ('database', 'Base de données'), ('auth', 'Authentification'), ('backup', 'Sauvegarde'), ('task', 'Tâche'), ('integration', 'Intégration'), ('security', 'Sécurité')], default='system', max_length=50, verbose_name='Source')),
                ('module', models.CharField(blank=True, max_length=100, verbose_name='Module')),
                ('action', models.CharField(max_length=100, verbose_name='Action')),
                ('message', models.TextField(verbose_name='Message')),
                ('details', models.JSONField(blank=True, default=dict, verbose_name='Détails')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='Adresse IP')),
                ('user_agent', models.TextField(blank=True, verbose_name='User Agent')),
                ('duration', models.FloatField(blank=True, help_text="Durée de l'opération en millisecondes", null=True, verbose_name='Durée (ms)')),
                ('is_resolved', models.BooleanField(default=False, verbose_name='Résolu')),
                ('resolved_at', models.DateTimeField(blank=True, null=True, verbose_name='Résolu le')),
                ('traceback', models.TextField(blank=True, verbose_name='Traceback')),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_logs', to=settings.AUTH_USER_MODEL, verbose_name='Résolu par')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='system_logs', to=settings.AUTH_USER_MODEL, verbose_name='Utilisateur')),
            ],
            options={
                'verbose_name': 'Journal système',
                'verbose_name_plural': 'Journaux système',
                'db_table': 'system_log',
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['timestamp'], name='system_log_timesta_2209e3_idx'), models.Index(fields=['level'], name='system_log_level_48c2a6_idx'), models.Index(fields=['source'], name='system_log_source_2fd3a3_idx'), models.Index(fields=['module'], name='system_log_module_e8c164_idx'), models.Index(fields=['user'], name='system_log_user_id_fcedc2_idx'), models.Index(fields=['is_resolved'], name='system_log_is_reso_3adc58_idx')],
            },
        ),
    ]
